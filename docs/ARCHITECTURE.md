# PhysicsForge Repository Architecture

This document describes the modular structure and organization of the PhysicsForge repository.

## Directory Structure

### Root Level
- **`README.md`**: Primary project documentation and overview
- **`GEMINI.md`**: Gemini AI agent integration guide
- **`Makefile`**: Primary build system (Unix/Linux/WSL)
- **`SConstruct`**: Alternative SCons build system
- **`win_make.ps1`**: Windows PowerShell build wrapper
- **`install_deps.sh`**: Dependency installation for Arch Linux
- **`PKGBUILD`**: Arch Linux package build configuration
- **`conftest.py`**: pytest configuration (root level for test discovery)
- **`equation_extractor.py`**: Re-export module for test compatibility
- **`requirements*.txt`**: Python dependency specifications

### Core Directories

#### `synthesis/`
**PRIMARY WORK AREA**: LaTeX book project for the monograph "Unified Field Theories and Advanced Physics: A Mathematical Synthesis."

- `chapters/`: Main content chapters organized by framework
- `modules/`: Reusable LaTeX components and equation snippets
- `scripts/`: LaTeX-specific build and compilation scripts
- `preamble.tex`: Framework-wide macros and package configuration
- `main.tex`: Master document assembly

#### `scripts/`
Python automation utilities for cataloging, extraction, validation, and reporting.

**Core Scripts:**
- `equation_extractor.py`: Primary equation extraction engine
- `build_catalog_pipeline.py`: Full catalog generation pipeline
- `merge_and_analyze_equations.py`: Equation deduplication and analysis
- `validate_catalog.py`: Catalog integrity validation
- `repo_audit.py`: Repository structure diagnostics
- `catalog_parity.py`: Module-catalog consistency checks
- `gap_todo.py`: TODO and gap analysis
- `todowrite.py`: TODO tracker generation
- `ascii_guard.py`: ASCII-only policy enforcement
- `ascii_normalize.py`: Unicode to ASCII normalization
- `link_modules.py`: Module linking system
- `dependency_audit.py`: Dependency analysis and reporting
- `update_data_readme.py`: Data directory documentation generation

**Specialized Scripts:**
- `pdf_*.py`: PDF text and image extraction tools
- `math_ocr_poc.py`: Mathematical OCR proof of concept
- `ollama_batch.py`: LLM batch processing
- `generate_figures.py`: Figure generation utilities
- `superforce/`: Superforce framework computation modules

#### `tests/`
Unit and integration tests for Python scripts and LaTeX compilation.

- `test_*.py`: Pytest-compatible test modules
- Organized by functionality (extraction, validation, pipeline, etc.)
- Run via `make test` or `pytest`

#### `notes/`
Working documents, drafts, synthesis summaries, and project management.

- `project_management/`: Project tracking and guides
- `references/`: Research literature summaries
- `misc/`: Miscellaneous working documents
- Active research notes and framework development

#### `docs/`
Guides, roadmaps, and comprehensive repository documentation.

**Core Documentation:**
- `AGENTS.md`: Repository guidelines for all agents
- `CLAUDE.md`: Claude AI agent integration guide
- `COPILOT.md`: GitHub Copilot agent integration guide
- `INSTALLATION_REQUIREMENTS.md`: Comprehensive setup guide
- `CONTRIBUTING.md`: Contribution guidelines
- `CI_CD_GUIDE.md`: CI/CD pipeline documentation
- `ARCHITECTURE.md`: This document - repository structure
- `README_SUPERFORCE.md`, `SUPERFORCE_README.md`: Superforce framework documentation
- `INTEGRATION_COMPLETE.md`: Integration status and notes
- `RELEASE_NOTES_v1.0.md`: Release documentation

**Schemas:**
- `metrics.schema.json`: Extraction metrics JSON schema
- `plan.schema.json`: Extraction plan JSON schema

#### `data/`
Staging area for catalogs, fixtures, and generated outputs.

- `catalogs/`: Generated equation catalogs (CSV)
- `fixtures/`: Test fixtures and sample data
- Auto-generated by pipeline scripts
- See `data/README.md` (generated by `make update_data_readme`)

#### `source_materials/`
Raw references and primary literature.

- `pdfs/`: PDF research papers
- `text/`: Text-based source materials
- External references, not modified by pipeline

#### `modules/`
Reusable LaTeX components, especially equation snippets.

- Linked into synthesis via `scripts/link_modules.py`
- Organized by framework and topic

#### `archive/`
Historical files, legacy scripts, and obsolete documentation preserved for reference.

**Subdirectories:**
- `legacy_scripts/`: Superseded or one-off utility scripts
- `historical_docs/`: Outdated documentation preserved for context
- `build_artifacts/`: Temporary or migration-related artifacts
- `synthesis_backups/`: Chapter backups from major refactors

**Note:** Files in archive/ are not part of active build/test pipeline.

#### `logs/`
Build and execution log outputs.

- Auto-generated by various scripts and tools
- Not committed to version control

#### `figures/`
Figure source files and generated outputs.

- `tikz/`: TikZ figure source files
- `svg/`: Generated SVG outputs
- Compiled via `make svg` or `make figures`

#### `.github/`
GitHub-specific configuration.

- `workflows/`: CI/CD workflow definitions
- `agents/`: Agent-specific instructions (not accessible to this agent)

## Build Systems

### Make (Primary)
- Cross-platform (Unix/Linux/WSL)
- Comprehensive targets for all workflows
- See `make help` for full list

### SCons (Alternative)
- Python-based build system
- Mirrors Makefile functionality
- See `scons -h` for help

### Windows PowerShell
- `win_make.ps1`: Windows-native wrapper
- Delegates to Python scripts
- LaTeX targets warn to use WSL

## Data Flow

```
notes/ + synthesis/ 
    v (extraction)
scripts/equation_extractor.py
    v (raw equations)
scripts/merge_and_analyze_equations.py
    v (deduplicated)
data/catalogs/equation_catalog.csv
    v (validation)
scripts/validate_catalog.py
    v (linking)
scripts/link_modules.py
    v (compilation)
synthesis/main.tex -> synthesis/main.pdf
```

## Testing Flow

```
make smoke -> Fast regression tests
make test -> Full pytest suite
make validate -> Catalog validation
make audit -> Repository audit
make parity -> Catalog-module consistency
make gaps -> TODO and gap analysis
make ci -> Full CI pipeline
```

## Documentation Standards

- **ASCII-only**: Code, scripts, LaTeX, docs (enforced by `make ascii_guard`)
- **Type-annotated**: Python helpers with type hints
- **Scoped commits**: Domain-focused commit messages
- **Snake_case**: Python filenames
- **Label conventions**: LaTeX labels follow `\label{eq:framework:topic}`
- **Markdown**: Level-one title, mirroring structure

## Development Workflow

1. **Make changes**: Edit code, scripts, or documentation
2. **Run tests**: `make smoke` for quick check
3. **Validate**: `make validate audit parity`
4. **Build**: `make latex` or `make latex_strict`
5. **Commit**: Scoped commit message
6. **CI**: GitHub Actions validates on push

## Cross-References

- Main guide: `README.md`
- Setup: `docs/INSTALLATION_REQUIREMENTS.md`
- Contributing: `docs/CONTRIBUTING.md`
- Agents: `docs/AGENTS.md`, `GEMINI.md`, `docs/CLAUDE.md`, `docs/COPILOT.md`
