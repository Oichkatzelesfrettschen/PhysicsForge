% Marginal Notes System Documentation
% File: marginal_notes_system.tex
% Purpose: LaTeX infrastructure for Lions Commentary-style marginal annotations
% For: Chapter 1 - Mathematical Preliminaries

% This file provides macros and guidelines for implementing a comprehensive marginal notes system
% in the Lions Commentary style for Chapter 1.

% PREAMBLE ADDITIONS (add to synthesis/preamble.tex)

% Required packages
% \usepackage{marginnote}  % For flexible margin notes
% \usepackage{mparhack}    % Fix margin note positioning
% \usepackage{sidenotes}   % Advanced margin note features

% Margin note command with formatting
\newcommand{\mnote}[1]{\marginnote{\footnotesize\textcolor{blue!70!black}{#1}}}

% Equation reference in margin
\newcommand{\meqref}[1]{\mnote{\textbf{Eq.~\ref{#1}}}}

% Physical interpretation note
\newcommand{\mphys}[1]{\mnote{\textcolor{purple}{\textbf{Physical:} #1}}}

% Computational note
\newcommand{\mcomp}[1]{\mnote{\textcolor{green!70!black}{\textbf{Compute:} #1}}}

% Dimensional analysis note
\newcommand{\mdim}[1]{\mnote{\textcolor{orange}{\textbf{Dims:} #1}}}

% Cross-reference note
\newcommand{\mxref}[1]{\mnote{\textcolor{cyan}{\textbf{See:} #1}}}

% Caution/pitfall note
\newcommand{\mcaution}[1]{\mnote{\textcolor{red}{\textbf{Caution:} #1}}}

% Historical note
\newcommand{\mhist}[1]{\mnote{\textcolor{brown}{\textbf{History:} #1}}}

% Example system note
\newcommand{\mex}[1]{\mnote{\textcolor{magenta}{\textbf{Example:} #1}}}

%-----------------------------------
% USAGE EXAMPLES FOR CHAPTER 1
%-----------------------------------

% EXAMPLE 1: GPS Paradox Section
\begin{example_usage}
The GPS satellites orbit at altitude $h = 20{,}200$ km
\mnote{4.17 Earth radii}
where the gravitational potential is weaker than at Earth's surface.
According to general relativity, clocks run faster in weaker gravitational fields.
\mphys{Time dilation: $\Delta t/t \sim GM/rc^2$}
The net time dilation effect is approximately $+38$ Î¼s per day,
\mdim{[$\mu$s/day]}
requiring active correction to maintain GPS accuracy within 10 meters.
\mxref{Table~\ref{tab:time_dilation_budget}}
\end{example_usage}

% EXAMPLE 2: Metric Tensor Definition
\begin{example_usage}
The metric tensor $g_{\mu\nu}(x)$
\mnote{Symmetric: $g_{\mu\nu} = g_{\nu\mu}$}
encodes the geometry of spacetime, defining the infinitesimal line element:
\begin{equation}
ds^2 = g_{\mu\nu} dx^\mu dx^\nu
\label{eq:metric_line_element}
\end{equation}
\mdim{[length$^2$]}
For the Schwarzschild metric,
\mex{Black holes, GPS}
\begin{equation}
g_{00} = -\left(1 - \frac{2GM}{r}\right), \quad
g_{rr} = \left(1 - \frac{2GM}{r}\right)^{-1}
\end{equation}
\mcaution{Coordinate singularity at $r=2GM$ (not physical)}
\mxref{Fig.~\ref{fig:schwarzschild_coordinates}}
\end{example_usage}

% EXAMPLE 3: Christoffel Symbols
\begin{example_usage}
The Christoffel symbols
\mnote{Connection coefficients}
$\Gamma^\mu_{\alpha\beta}$ are computed from the metric and its derivatives:
\begin{equation}
\Gamma^\mu_{\alpha\beta} = \frac{1}{2} g^{\mu\nu} 
\left(\partial_\alpha g_{\nu\beta} + \partial_\beta g_{\nu\alpha} - \partial_\nu g_{\alpha\beta}\right)
\label{eq:christoffel_definition}
\end{equation}
\mcomp{Use CAS for $D \geq 4$}
\mdim{[length$^{-1}$]}
These are \emph{not} tensors
\mcaution{Inhomogeneous transformation}
but transform with an additional term under coordinate changes.
\mphys{Encode gravitational acceleration}
In $D=4$ spacetime, symmetry reduces the number of independent components from $64$ to $40$.
\mxref{Fig.~\ref{fig:christoffel_computation}}
\end{example_usage}

% EXAMPLE 4: Riemann Tensor
\begin{example_usage}
The Riemann curvature tensor
\mhist{Riemann 1854}
$R^\alpha_{\beta\mu\nu}$ measures the failure of parallel transport around closed loops:
\begin{equation}
R^\alpha_{\beta\mu\nu} = \partial_\mu \Gamma^\alpha_{\nu\beta} - \partial_\nu \Gamma^\alpha_{\mu\beta}
+ \Gamma^\alpha_{\mu\lambda} \Gamma^\lambda_{\nu\beta} - \Gamma^\alpha_{\nu\lambda} \Gamma^\lambda_{\mu\beta}
\label{eq:riemann_tensor}
\end{equation}
\mdim{[length$^{-2}$]}
\mcomp{$O(D^5)$ complexity}
It has $D^4$ components but only $D^2(D^2-1)/12$ are independent due to symmetries.
\mnote{In 4D: $256 \to 20$}
For a small loop of area $A$, the vector rotation is $\Delta V^\alpha \sim R^\alpha_{\ \beta\mu\nu} A V^\beta$.
\mphys{Tidal forces, geodesic deviation}
\mxref{Fig.~\ref{fig:riemann_holonomy}, Tab.~\ref{tab:riemann_properties}}
\end{example_usage}

% EXAMPLE 5: Einstein Equations
\begin{example_usage}
The Einstein field equations
\mhist{Einstein 1915}
relate spacetime geometry to matter-energy content:
\begin{equation}
G_{\mu\nu} \equiv R_{\mu\nu} - \frac{1}{2} R g_{\mu\nu} = 8\pi G T_{\mu\nu}
\label{eq:einstein_equations}
\end{equation}
\mdim{[length$^{-2}$] both sides}
\mnote{10 independent equations}
The left side $G_{\mu\nu}$ is purely geometric
\mphys{Spacetime curvature}
while the right side $T_{\mu\nu}$ describes matter and energy.
\mphys{Mass-energy distribution}
The factor $8\pi G$ ensures Newtonian limit
\mex{$G_{00} \approx \nabla^2 \Phi$ weak field}
and the equations are divergence-free by the Bianchi identity.
\mcomp{$\nabla^\mu G_{\mu\nu} = 0$ identically}
\mxref{Fig.~\ref{fig:einstein_equations}}
\end{example_usage}

%-----------------------------------
% SYSTEMATIC ANNOTATION GUIDE
%-----------------------------------

% For comprehensive Chapter 1 annotation, apply marginal notes according to:

% 1. EVERY EQUATION:
%    - \mdim{...} for dimensional analysis
%    - \mcomp{...} for computational guidance
%    - \mxref{...} for related figures/tables

% 2. EVERY NEW CONCEPT:
%    - \mnote{Brief definition}
%    - \mphys{Physical interpretation}
%    - \mhist{Historical context when relevant}

% 3. EVERY WORKED EXAMPLE:
%    - \mex{System name}
%    - \mnote{Key parameters}
%    - \mdim{Check units}

% 4. EVERY POTENTIAL PITFALL:
%    - \mcaution{Warning about common mistake}
%    - \mnote{Clarification}

% 5. ALL CROSS-REFERENCES:
%    - \mxref{Fig/Tab/Sec/Eq references}
%    - \mnote{Related material locations}

%-----------------------------------
% BENEFITS OF MARGINAL NOTES SYSTEM
%-----------------------------------

% This systematic marginal annotation provides:
% 
% 1. RAPID REFERENCE: Students can scan margins for key information
% 2. MULTI-LEVEL ACCESS: Brief notes for quick lookup, main text for detail
% 3. VISUAL STRUCTURE: Color-coded notes organize information by type
% 4. PEDAGOGICAL SCAFFOLDING: Physical intuition alongside formalism
% 5. COMPUTATIONAL GUIDANCE: Algorithm complexity and tool recommendations
% 6. DIMENSIONAL RIGOR: Units checked at every step
% 7. CROSS-REFERENCE NETWORK: Easy navigation between related concepts
% 8. HISTORICAL CONTEXT: Intellectual heritage acknowledged
% 9. PITFALL PREVENTION: Common mistakes explicitly flagged
% 10. LIONS COMMENTARY STYLE: Exhaustive annotation for complete understanding

%-----------------------------------
% IMPLEMENTATION CHECKLIST
%-----------------------------------

% To fully implement marginal notes system in Chapter 1:
%
% [ ] Add marginal note packages to preamble
% [ ] Define all marginal note macros (\mnote, \mphys, \mcomp, etc.)
% [ ] Section 1 (GPS Paradox): Add ~20 marginal notes
% [ ] Section 2 (Metric Tensor): Add ~15 marginal notes
% [ ] Section 3 (Christoffel): Add ~25 marginal notes
% [ ] Section 4 (Covariant Derivatives): Add ~20 marginal notes
% [ ] Section 5 (Riemann Tensor): Add ~30 marginal notes
% [ ] Section 6 (Einstein Tensor): Add ~15 marginal notes
% [ ] Section 7 (Quantum Formalism): Add ~25 marginal notes
% [ ] Review: Ensure consistent color coding
% [ ] Review: Check all cross-references valid
% [ ] Review: Verify dimensional analysis complete
% [ ] Compile: Test margin note positioning
% [ ] Adjust: Fine-tune spacing if needed

% ESTIMATED: ~150 marginal notes total for comprehensive Chapter 1 annotation

%-----------------------------------
% TECHNICAL NOTES
%-----------------------------------

% Margin width: Adjust in document class options
%   \documentclass[..., marginparwidth=2.5cm, ...]{article}
%
% Two-sided layout: Use \reversemarginpar for alternating sides
%
% Margin note overflow: Use \marginnote[offset]{text} to adjust vertical position
%
% Color consistency: Define colors in preamble for uniform appearance
%   \definecolor{physical}{RGB}{128,0,128}  % Purple for physical
%   \definecolor{computational}{RGB}{0,128,0}  % Green for computational
%   etc.

\end{example_usage}
